// Generated by CoffeeScript 1.7.1
var FBScript, PageScript;

window.publishHelloWorld = (function(_this) {
  return function() {
    var pageToken;
    pageToken = document.getElementById("pageToken").innerHTML;
    return FB.api("/me/feed", "post", {
      message: "Hello, world! " + (Math.random(1000)),
      access_token: pageToken
    }, function(response) {
      console.log("API response");
      console.log(response);
      return document.getElementById("publishBtn").innerHTML = "API response is " + response.id;
    });
  };
})(this);

window.pageLogin = (function(_this) {
  return function() {
    console.log('loggin');
    return FB.api("/me/accounts?fields=name,access_token,link", function(response) {
      var i, li, list;
      console.log(response);
      list = document.getElementById("pagesList");
      i = 0;
      while (i < response.data.length) {
        li = document.createElement("li");
        li.innerHTML = response.data[i].name;
        li.dataset.token = response.data[i].access_token;
        li.dataset.link = response.data[i].link;
        li.className = "btn btn-mini";
        li.onclick = function() {
          document.getElementById("pageName").innerHTML = this.innerHTML;
          document.getElementById("pageToken").innerHTML = this.dataset.token;
          document.getElementById("pageLink").setAttribute("href", this.dataset.link);
        };
        list.appendChild(li);
        i++;
      }
      console.log("done");
    });
  };
})(this);

window.fbAsyncInit = function() {
  FB.init({
    appId: document.getElementById("fb-root").getAttribute("data-app-id"),
    status: true,
    cookie: true,
    xfbml: true
  });
  FB.Event.subscribe('auth.login', function(response) {
    return window.location = window.location;
  });
  FB.Canvas.setAutoGrow();
  return FB.getLoginStatus(function(data) {
    var accessToken, uid;
    if (data.status === "connected") {
      uid = data.authResponse.userID;
      accessToken = data.authResponse.accessToken;
      return FB.api("/me", function(data) {
        return console.log("Hello " + data.name);
      });
    } else {
      if (response.status === "not_authorized") {

      } else {

      }
    }
  });
};

PageScript = document.getElementsByTagName("script")[0];

if (document.getElementById("FBScript")) {
  return;
}

FBScript = document.createElement("script");

FBScript.id = "FBScript";

FBScript.async = true;

FBScript.src = "//connect.facebook.net/en_US/all.js";

PageScript.parentNode.insertBefore(FBScript, PageScript);
